2023-02-15 12:03:22 - INFO - Training/evaluation parameters: Namespace(ablation='', adam_epsilon=1e-08, annotation='./data/annotation/filter_data.json', audio_feature_path='./models/CCT_MMC_base1/audio-feature/', audio_part_num=16, audio_wav2vec_path='./models/MFMGR/audio_feature.json', base1_audio_sus='./models/CCT_MMC_base1/audio_sus.json', bert_cache='./models/cache/bert/', bert_dir='hfl/chinese-roberta-wwm-ext', bs1_audio_hidden_size=513, bs1_kernel_size=3, bs1_out_channel=256, bs1_video_hidden_size=2048, cls_num=10, device='cuda', early_stop_epoch=10, frequency_dimension=513, fusion_size=3, learning_rate=0.001, max_frame=32, max_seq_len=256, max_steps=2000, modals=['summary'], mode='train', model_name='mymodel', model_save_path='./models/CCT_MMC_base1/save/paper/', n_gpu=4, note='mymodel', num_workers=4, other_model_lr=0.0005, partial_len=3.0, partial_num=5, pic_video_path='./data/pic-videos/', prefetch=64, pretrain_model_lr=5e-05, resnet_cache='./models/cache/resnet152', save_model_name='/model.bin', seed=42, swin_pretrained_path='./models/cache/swin/swin_small_patch4_window7_224_22k.pth', temporal_dimension=130, test_ratio=0.2, train_batch_size=16, val_batch_size=32, val_ratio=0.1, vgg_model_path='./data/vgg16/vgg16-397923af.pth', warmup_steps=200, wav2vec_hidden_size=1024, weight_decay=0.0001, word2vec_path='./data/word2vec/sgns.target.word-word.dynwin5.thr10.neg5.dim300.iter5')
2023-02-15 12:03:22 - INFO - >>> loading data... from ./data/annotation/filter_data.json ./data/pic-videos/
2023-02-15 12:04:41 - INFO - Training/evaluation parameters: Namespace(ablation='', adam_epsilon=1e-08, annotation='./data/annotation/filter_data.json', audio_feature_path='./models/CCT_MMC_base1/audio-feature/', audio_part_num=16, audio_wav2vec_path='./models/MFMGR/audio_feature.json', base1_audio_sus='./models/CCT_MMC_base1/audio_sus.json', bert_cache='./models/cache/bert/', bert_dir='hfl/chinese-roberta-wwm-ext', bs1_audio_hidden_size=513, bs1_kernel_size=3, bs1_out_channel=256, bs1_video_hidden_size=2048, cls_num=10, device='cuda', early_stop_epoch=10, frequency_dimension=513, fusion_size=3, learning_rate=0.001, max_frame=32, max_seq_len=256, max_steps=2000, modals=['summary'], mode='train', model_name='mymodel', model_save_path='./models/CCT_MMC_base1/save/paper/', n_gpu=4, note='mymodel', num_workers=4, other_model_lr=0.0005, partial_len=3.0, partial_num=5, pic_video_path='./data/pic-videos/', prefetch=64, pretrain_model_lr=5e-05, resnet_cache='./models/cache/resnet152', save_model_name='/model.bin', seed=42, swin_pretrained_path='./models/cache/swin/swin_small_patch4_window7_224_22k.pth', temporal_dimension=130, test_ratio=0.2, train_batch_size=16, val_batch_size=32, val_ratio=0.1, vgg_model_path='./data/vgg16/vgg16-397923af.pth', warmup_steps=200, wav2vec_hidden_size=1024, weight_decay=0.0001, word2vec_path='./data/word2vec/sgns.target.word-word.dynwin5.thr10.neg5.dim300.iter5')
2023-02-15 12:04:41 - INFO - >>> loading data... from ./data/annotation/filter_data.json ./data/pic-videos/
2023-02-15 12:05:46 - INFO - Training/evaluation parameters: Namespace(ablation='', adam_epsilon=1e-08, annotation='./data/annotation/filter_data.json', audio_feature_path='./models/CCT_MMC_base1/audio-feature/', audio_part_num=16, audio_wav2vec_path='./models/MFMGR/audio_feature.json', base1_audio_sus='./models/CCT_MMC_base1/audio_sus.json', bert_cache='./models/cache/bert/', bert_dir='hfl/chinese-roberta-wwm-ext', bs1_audio_hidden_size=513, bs1_kernel_size=3, bs1_out_channel=256, bs1_video_hidden_size=2048, cls_num=10, device='cuda', early_stop_epoch=10, frequency_dimension=513, fusion_size=3, learning_rate=0.001, max_frame=32, max_seq_len=256, max_steps=2000, modals=['summary'], mode='train', model_name='mymodel', model_save_path='./models/CCT_MMC_base1/save/paper/', n_gpu=4, note='mymodel', num_workers=4, other_model_lr=0.0005, partial_len=3.0, partial_num=5, pic_video_path='./data/pic-videos/', prefetch=64, pretrain_model_lr=5e-05, resnet_cache='./models/cache/resnet152', save_model_name='/model.bin', seed=42, swin_pretrained_path='./models/cache/swin/swin_small_patch4_window7_224_22k.pth', temporal_dimension=130, test_ratio=0.2, train_batch_size=16, val_batch_size=32, val_ratio=0.1, vgg_model_path='./data/vgg16/vgg16-397923af.pth', warmup_steps=200, wav2vec_hidden_size=1024, weight_decay=0.0001, word2vec_path='./data/word2vec/sgns.target.word-word.dynwin5.thr10.neg5.dim300.iter5')
2023-02-15 12:05:46 - INFO - >>> loading data... from ./data/annotation/filter_data.json ./data/pic-videos/
2023-02-15 12:06:03 - INFO - >>> loading data... train_size: 71, val_size: 9, test_size 19
2023-02-15 12:06:31 - INFO - Training/evaluation parameters: Namespace(ablation='', adam_epsilon=1e-08, annotation='./data/annotation/filter_data.json', audio_feature_path='./models/CCT_MMC_base1/audio-feature/', audio_part_num=16, audio_wav2vec_path='./models/MFMGR/audio_feature.json', base1_audio_sus='./models/CCT_MMC_base1/audio_sus.json', bert_cache='./models/cache/bert/', bert_dir='hfl/chinese-roberta-wwm-ext', bs1_audio_hidden_size=513, bs1_kernel_size=3, bs1_out_channel=256, bs1_video_hidden_size=2048, cls_num=10, device='cuda', early_stop_epoch=10, frequency_dimension=513, fusion_size=3, learning_rate=0.001, max_frame=32, max_seq_len=256, max_steps=2000, modals=['summary'], mode='train', model_name='mymodel', model_save_path='./models/CCT_MMC_base1/save/paper/', n_gpu=4, note='mymodel', num_workers=4, other_model_lr=0.0005, partial_len=3.0, partial_num=5, pic_video_path='./data/pic-videos/', prefetch=64, pretrain_model_lr=5e-05, resnet_cache='./models/cache/resnet152', save_model_name='/model.bin', seed=42, swin_pretrained_path='./models/cache/swin/swin_small_patch4_window7_224_22k.pth', temporal_dimension=130, test_ratio=0.2, train_batch_size=16, val_batch_size=32, val_ratio=0.1, vgg_model_path='./data/vgg16/vgg16-397923af.pth', warmup_steps=200, wav2vec_hidden_size=1024, weight_decay=0.0001, word2vec_path='./data/word2vec/sgns.target.word-word.dynwin5.thr10.neg5.dim300.iter5')
2023-02-15 12:06:31 - INFO - >>> loading data... from ./data/annotation/filter_data.json ./data/pic-videos/
2023-02-15 12:06:33 - INFO - >>> loading data... train_size: 71, val_size: 9, test_size 19
2023-02-15 12:08:14 - INFO - Training/evaluation parameters: Namespace(ablation='', adam_epsilon=1e-08, annotation='./data/annotation/filter_data.json', audio_feature_path='./models/CCT_MMC_base1/audio-feature/', audio_part_num=16, audio_wav2vec_path='./models/MFMGR/audio_feature.json', base1_audio_sus='./models/CCT_MMC_base1/audio_sus.json', bert_cache='./models/cache/bert/', bert_dir='hfl/chinese-roberta-wwm-ext', bs1_audio_hidden_size=513, bs1_kernel_size=3, bs1_out_channel=256, bs1_video_hidden_size=2048, cls_num=10, device='cuda', early_stop_epoch=10, frequency_dimension=513, fusion_size=3, learning_rate=0.001, max_frame=32, max_seq_len=256, max_steps=2000, modals=['summary'], mode='train', model_name='mymodel', model_save_path='./models/CCT_MMC_base1/save/paper/', n_gpu=4, note='mymodel', num_workers=4, other_model_lr=0.0005, partial_len=3.0, partial_num=5, pic_video_path='./data/pic-videos/', prefetch=64, pretrain_model_lr=5e-05, resnet_cache='./models/cache/resnet152', save_model_name='/model.bin', seed=42, swin_pretrained_path='./models/cache/swin/swin_small_patch4_window7_224_22k.pth', temporal_dimension=130, test_ratio=0.2, train_batch_size=16, val_batch_size=32, val_ratio=0.1, vgg_model_path='./data/vgg16/vgg16-397923af.pth', warmup_steps=200, wav2vec_hidden_size=1024, weight_decay=0.0001, word2vec_path='./data/word2vec/sgns.target.word-word.dynwin5.thr10.neg5.dim300.iter5')
2023-02-15 12:08:14 - INFO - >>> loading data... from ./data/annotation/filter_data.json ./data/pic-videos/
2023-02-15 12:08:17 - INFO - >>> loading data... train_size: 71, val_size: 9, test_size 19
2023-02-15 12:09:00 - INFO - >>> begin training...
2023-02-15 12:09:11 - INFO - Epoch=1|step=   2/5|loss= 1.278|lr=7.5e-07|acc=0.6438|time=10.84s
2023-02-15 12:09:12 - INFO - train_loss=1.32
2023-02-15 12:09:12 - INFO - >>> begin validation...
2023-02-15 12:09:12 - INFO - step=   0/1|loss= 1.246|acc=0.6222|time=0.3776s
2023-02-15 12:09:12 - INFO - >>> val_loss: 1.246394157409668, matrics: {'macro_f1': 0.203333, 'micro_f1': 0.37037, 'macro_list': [0.0, 0.0, 0.0, 0.6667, 0.0, 0.5, 0.2, 0.3333, 0.0, 0.3333], 'auc_pr_macro': nan, 'auc_pr_micro': 0.299033, 'all_1 / true_1': 0.526316, 'all_1 / pre_1': 0.285714}
2023-02-15 12:09:12 - INFO - >> model saving...
2023-02-15 12:10:32 - INFO - Training/evaluation parameters: Namespace(ablation='', adam_epsilon=1e-08, annotation='./data/annotation/filter_data.json', audio_feature_path='./models/CCT_MMC_base1/audio-feature/', audio_part_num=16, audio_wav2vec_path='./models/MFMGR/audio_feature.json', base1_audio_sus='./models/CCT_MMC_base1/audio_sus.json', bert_cache='./models/cache/bert/', bert_dir='hfl/chinese-roberta-wwm-ext', bs1_audio_hidden_size=513, bs1_kernel_size=3, bs1_out_channel=256, bs1_video_hidden_size=2048, cls_num=10, device='cuda', early_stop_epoch=10, frequency_dimension=513, fusion_size=3, learning_rate=0.001, max_frame=32, max_seq_len=256, max_steps=2000, modals=['summary'], mode='train', model_name='mymodel', model_save_path='./models/CCT_MMC_base1/save/paper/', n_gpu=4, note='mymodel', num_workers=4, other_model_lr=0.0005, partial_len=3.0, partial_num=5, pic_video_path='./data/pic-videos/', prefetch=64, pretrain_model_lr=5e-05, resnet_cache='./models/cache/resnet152', save_model_name='/model.bin', seed=42, swin_pretrained_path='./models/cache/swin/swin_small_patch4_window7_224_22k.pth', temporal_dimension=130, test_ratio=0.2, train_batch_size=16, val_batch_size=32, val_ratio=0.1, vgg_model_path='./data/vgg16/vgg16-397923af.pth', warmup_steps=200, wav2vec_hidden_size=1024, weight_decay=0.0001, word2vec_path='./data/word2vec/sgns.target.word-word.dynwin5.thr10.neg5.dim300.iter5')
2023-02-15 12:10:32 - INFO - >>> loading data... from ./data/annotation/filter_data.json ./data/pic-videos/
2023-02-15 12:10:35 - INFO - >>> loading data... train_size: 71, val_size: 9, test_size 19
2023-02-15 12:10:43 - INFO - >>> begin training...
2023-02-15 12:10:55 - INFO - Epoch=1|step=   2/5|loss= 1.278|lr=7.5e-07|acc=0.6438|time=11.4s
2023-02-15 12:10:55 - INFO - train_loss=1.32
2023-02-15 12:10:55 - INFO - >>> begin validation...
2023-02-15 12:10:56 - INFO - step=   0/1|loss= 1.246|acc=0.6222|time=0.3773s
2023-02-15 12:10:56 - INFO - >>> val_loss: 1.246394157409668, matrics: {'macro_f1': 0.203333, 'micro_f1': 0.37037, 'macro_list': [0.0, 0.0, 0.0, 0.6667, 0.0, 0.5, 0.2, 0.3333, 0.0, 0.3333], 'auc_pr_macro': nan, 'auc_pr_micro': 0.299033, 'all_1 / true_1': 0.526316, 'all_1 / pre_1': 0.285714}
2023-02-15 12:10:56 - INFO - >> model saving...
2023-02-15 12:11:51 - INFO - Training/evaluation parameters: Namespace(ablation='', adam_epsilon=1e-08, annotation='./data/annotation/filter_data.json', audio_feature_path='./models/CCT_MMC_base1/audio-feature/', audio_part_num=16, audio_wav2vec_path='./models/MFMGR/audio_feature.json', base1_audio_sus='./models/CCT_MMC_base1/audio_sus.json', bert_cache='./models/cache/bert/', bert_dir='hfl/chinese-roberta-wwm-ext', bs1_audio_hidden_size=513, bs1_kernel_size=3, bs1_out_channel=256, bs1_video_hidden_size=2048, cls_num=10, device='cuda', early_stop_epoch=10, frequency_dimension=513, fusion_size=3, learning_rate=0.001, max_frame=32, max_seq_len=256, max_steps=2000, modals=['summary'], mode='train', model_name='mymodel', model_save_path='./models/MFMGC/save/', n_gpu=4, note='mymodel', num_workers=4, other_model_lr=0.0005, partial_len=3.0, partial_num=5, pic_video_path='./data/pic-videos/', prefetch=64, pretrain_model_lr=5e-05, resnet_cache='./models/cache/resnet152', save_model_name='/model.bin', seed=42, swin_pretrained_path='./models/cache/swin/swin_small_patch4_window7_224_22k.pth', temporal_dimension=130, test_ratio=0.2, train_batch_size=16, val_batch_size=32, val_ratio=0.1, vgg_model_path='./data/vgg16/vgg16-397923af.pth', warmup_steps=200, wav2vec_hidden_size=1024, weight_decay=0.0001, word2vec_path='./data/word2vec/sgns.target.word-word.dynwin5.thr10.neg5.dim300.iter5')
2023-02-15 12:11:51 - INFO - >>> loading data... from ./data/annotation/filter_data.json ./data/pic-videos/
2023-02-15 12:11:54 - INFO - >>> loading data... train_size: 71, val_size: 9, test_size 19
2023-02-15 12:12:02 - INFO - >>> begin training...
2023-02-15 12:12:14 - INFO - Epoch=1|step=   2/5|loss= 1.278|lr=7.5e-07|acc=0.6438|time=11.19s
2023-02-15 12:12:14 - INFO - train_loss=1.32
2023-02-15 12:12:14 - INFO - >>> begin validation...
2023-02-15 12:12:15 - INFO - step=   0/1|loss= 1.246|acc=0.6222|time=0.4011s
2023-02-15 12:12:15 - INFO - >>> val_loss: 1.246394157409668, matrics: {'macro_f1': 0.203333, 'micro_f1': 0.37037, 'macro_list': [0.0, 0.0, 0.0, 0.6667, 0.0, 0.5, 0.2, 0.3333, 0.0, 0.3333], 'auc_pr_macro': nan, 'auc_pr_micro': 0.299033, 'all_1 / true_1': 0.526316, 'all_1 / pre_1': 0.285714}
2023-02-15 12:12:15 - INFO - >> model saving...
2023-02-15 12:13:02 - INFO - Training/evaluation parameters: Namespace(ablation='', adam_epsilon=1e-08, annotation='./data/annotation/filter_data.json', audio_feature_path='./models/CCT_MMC_base1/audio-feature/', audio_part_num=16, audio_wav2vec_path='./models/MFMGR/audio_feature.json', base1_audio_sus='./models/CCT_MMC_base1/audio_sus.json', bert_cache='./models/cache/bert/', bert_dir='hfl/chinese-roberta-wwm-ext', bs1_audio_hidden_size=513, bs1_kernel_size=3, bs1_out_channel=256, bs1_video_hidden_size=2048, cls_num=10, device='cuda', early_stop_epoch=10, frequency_dimension=513, fusion_size=3, learning_rate=0.001, max_frame=32, max_seq_len=256, max_steps=2000, modals=['summary'], mode='train', model_name='mymodel', model_save_path='./models/MFMGC/save/', n_gpu=4, note='mymodel', num_workers=4, other_model_lr=0.0005, partial_len=3.0, partial_num=5, pic_video_path='./data/pic-videos/', prefetch=64, pretrain_model_lr=5e-05, resnet_cache='./models/cache/resnet152', save_model_name='/model.bin', seed=42, swin_pretrained_path='./models/cache/swin/swin_small_patch4_window7_224_22k.pth', temporal_dimension=130, test_ratio=0.2, train_batch_size=16, val_batch_size=32, val_ratio=0.1, vgg_model_path='./data/vgg16/vgg16-397923af.pth', warmup_steps=200, wav2vec_hidden_size=1024, weight_decay=0.0001, word2vec_path='./data/word2vec/sgns.target.word-word.dynwin5.thr10.neg5.dim300.iter5')
2023-02-15 12:13:02 - INFO - >>> loading data... from ./data/annotation/filter_data.json ./data/pic-videos/
2023-02-15 12:13:05 - INFO - >>> loading data... train_size: 71, val_size: 9, test_size 19
2023-02-15 12:13:14 - INFO - >>> begin training...
2023-02-15 12:13:24 - INFO - Epoch=1|step=   2/5|loss= 1.278|lr=7.5e-07|acc=0.6438|time=9.858s
2023-02-15 12:13:24 - INFO - train_loss=1.32
2023-02-15 12:13:24 - INFO - >>> begin validation...
2023-02-15 12:13:25 - INFO - step=   0/1|loss= 1.246|acc=0.6222|time=0.3903s
2023-02-15 12:13:25 - INFO - >>> val_loss: 1.246394157409668, matrics: {'macro_f1': 0.203333, 'micro_f1': 0.37037, 'macro_list': [0.0, 0.0, 0.0, 0.6667, 0.0, 0.5, 0.2, 0.3333, 0.0, 0.3333], 'auc_pr_macro': nan, 'auc_pr_micro': 0.299033, 'all_1 / true_1': 0.526316, 'all_1 / pre_1': 0.285714}
2023-02-15 12:13:25 - INFO - >> model saving...
2023-02-15 12:13:28 - INFO - Epoch=2|step=   2/5|loss= 1.184|lr=2e-06|acc=0.6625|time=1.234s
2023-02-15 12:13:28 - INFO - train_loss=1.327
2023-02-15 12:13:28 - INFO - >>> begin validation...
2023-02-15 12:13:29 - INFO - step=   0/1|loss= 1.233|acc=0.6333|time=0.3871s
2023-02-15 12:13:29 - INFO - >>> val_loss: 1.232832670211792, matrics: {'macro_f1': 0.21359, 'micro_f1': 0.4, 'macro_list': [0.0, 0.0, 0.0, 0.7692, 0.0, 0.5, 0.2, 0.3333, 0.0, 0.3333], 'auc_pr_macro': nan, 'auc_pr_micro': 0.32468, 'all_1 / true_1': 0.578947, 'all_1 / pre_1': 0.305556}
2023-02-15 12:13:29 - INFO - >> model saving...
2023-02-15 12:13:31 - INFO - Epoch=3|step=   2/5|loss= 1.143|lr=3.25e-06|acc=0.6375|time=1.24s
2023-02-15 12:13:32 - INFO - train_loss=1.255
2023-02-15 12:13:32 - INFO - >>> begin validation...
2023-02-15 12:13:32 - INFO - step=   0/1|loss= 1.219|acc=0.6|time=0.39s
2023-02-15 12:13:32 - INFO - >>> val_loss: 1.2194187641143799, matrics: {'macro_f1': 0.24619, 'micro_f1': 0.454545, 'macro_list': [0.0, 0.0, 0.0, 0.7143, 0.0, 0.5, 0.2, 0.7143, 0.0, 0.3333], 'auc_pr_macro': nan, 'auc_pr_micro': 0.350071, 'all_1 / true_1': 0.789474, 'all_1 / pre_1': 0.319149}
2023-02-15 12:13:32 - INFO - >> model saving...
2023-02-15 12:13:35 - INFO - Epoch=4|step=   2/5|loss= 1.119|lr=4.5e-06|acc=0.625|time=1.265s
2023-02-15 12:13:36 - INFO - train_loss=1.258
2023-02-15 12:13:36 - INFO - >>> begin validation...
2023-02-15 12:13:36 - INFO - step=   0/1|loss= 1.205|acc=0.4889|time=0.3826s
2023-02-15 12:13:36 - INFO - >>> val_loss: 1.2048323154449463, matrics: {'macro_f1': 0.24619, 'micro_f1': 0.394737, 'macro_list': [0.0, 0.0, 0.0, 0.7143, 0.0, 0.5, 0.2, 0.7143, 0.0, 0.3333], 'auc_pr_macro': nan, 'auc_pr_micro': 0.383207, 'all_1 / true_1': 0.789474, 'all_1 / pre_1': 0.263158}
